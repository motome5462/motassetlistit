<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Report</title>
</head>


<body>
    <header>
        <!-- Navbar -->
        <% include index.ejs %>
    </header>
    <div class="container mt-5">
        <h1 style="font-size: 60px">Report</h1>
        <% if (data && data.length> 0) { %>
            <% data.forEach((item, index)=> { %>
                <div class="mt-5">
                    <h2 style="font-size: 40px">User Owner</h2>
                    <table class="table table-bordered" style="border: 1px solid rgb(0, 0, 0); ">
                        <thead>
                                <th>No.</th>
                                <th>Asset ID</th>
                                <th>Date</th>
                                <th>User Owner</th>
                                <th>Company</th>
                                <th>Dept</th>
                                <th>Delivery dates</th>
                                <th>Remark</th>
                        </thead>
                            <tbody>
                                <td><%= index + 1 %></td>
                                <td><%= item.assetid %></td>
                                <td><%= new Date(item.assetitlistsdate).toDateString() %></td>
                                <td><%= item.name %></td>
                                <td><%= item.assetitlistscompany.join(', ') %></td>
                                <td><%= item.dept %></td>
                                <td><%= new Date(item.deliverydate).toDateString() %></td>
                                <td><%= item.assetitlistsremark %></td>
                            </tbody>
                        <td colspan="8"style="font-size: 25px"><strong>Hardware</strong></td>
                            <thead>
                                <th>Device</th>
                                <th>Device-Type</th>
                                <th>Model</th>
                                <th>S/N</th>
                                <th>CPU</th>
                                <th>CPU Speed</th>
                                <th>Harddisk</th>
                                <th>RAM</th>
                        </thead>
                            <tbody>
                                <td><%= item.device %></td>
                                <td><%= item.devicetype %></td>
                                <td ><%= item.devicemodel%></td>
                                <td ><%= item.devicesn %></td>
                                <td><%= item.cpu %> <%=item.cputype%></td>
                                <td><%= item.speed %></td>
                                <td><%= item.harddisk %></td>
                                <td><%= item.ram %></td>
                            </tbody>
                            <td colspan="8"style="font-size: 25px"><strong>Accessory</strong></td>
                            <thead>
                                <th>ROM</th>
                                <th>ROM Detail</th>
                                <th>Monitor</th>
                                <th>Monitor Detail</th>
                                <th>Keyboard</th>
                                <th>Keyboard Detail</th>
                                <th>Mouse</th>
                                <th>Mouse Detail</th>
                                </thead>
                            <tbody>
                                <td><%= item.romdrive %> <%= item.romdrivetype %></td>
                                <td><%= item.romsn %> <%= item.romassetid %></td>
                                <td ><%= item.monitor%> <%= item.monitortype%></td>
                                <td ><%= item.monitorsn %> <%= item.monitorassetid%></td>
                                <td><%= item.keyboard %> <%=item.keyboardtype%></td>
                                <td><%= item.keyboardsn %> <%= item.keyboardassetid%></td>
                                <td><%= item.mouse %> <%= item.mousetype%></td>
                                <td><%= item.mousesn %> <%= item.mouseassetid%></td>
                            </tbody>
                            <thead>
                                <th>Printer</th>
                                <th>Printer Detail</th>
                                <th>Adaptor</th>
                                <th>Adaptor Detail</th>
                                <th>UPS</th>
                                <th>UPS Detail</th>
                                <th>Other</th>
                                <th>Other Detail</th>
                                </thead>
                            <tbody>
                                <td><%= item.printer %> <%= item.printermodel%> <%= item.printertype%></td>
                                <td><%= item.printersn %> <%= item.printerassetid%></td>
                                <td><%= item.adaptor %></td>
                                <td><%= item.adaptorsn %></td>
                                <td ><%= item.ups%> <%= item.upstype%> <%= item.upsva%></td>
                                <td ><%= item.upstypemodel%> <%= item.upstypesn %> <%= item.upstypeassetid%></td>
                                <td><%= item.other1 %> </td>
                                <td><%= item.othersn %> </td>
                            </tbody>
                            <td colspan="8"style="font-size: 25px"><strong>Software</strong></td>
                            <thead>
                                <th>OS</th>
                                <th>OS s/n</th>
                                <th>Office</th>
                                <th>Office s/n</th>
                                <th>Antivirus</th>
                                <th>pdf</th>
                                <th>utility</th>
                                <th>other</th>
                            </thead>
                            <tbody>
                                <td><%= item.os %> <%= item.ostype %></td>
                                <td><%= item.ossn %></td>
                                <td><%= item.office%> <%= item.officetype%></td>
                                <td><%= item.officesn %></td>
                                <td><%= item.antivirus %></td>
                                <td><%= item.pdf %></td>
                                <td><%= item.utility %></td>
                                <td><%= item.other2 %></td>
                            </tbody>
                            <thead>
                                <th colspan="4"class="text-center">Addprinter</th>
                                <th colspan="4"class="text-center">Mapdrive</th>
                            </thead>
                            <tbody>
                                <td colspan="4"class="text-center"><%= item.mapdrive %></td>
                                <td colspan="4"class="text-center"><%= item.addprinter %></td>
                            </tbody>

              <% if (item.repairs && item.repairs.length > 0) { %>
                <tr>
                  <td colspan="9">
                    <h3 style="font-size: 25px"><strong>Detail Repair</strong></h3>
                    <table class="table table-bordered mt-2" style="border: 1px solid black; ">
                      <thead>
                        <tr>
                          <th>No.</th>
                          <th>Date</th>
                          <th>ComputerName</th>
                          <th>Detail Repair</th>
                          <th>Value</th>
                          <th>Success</th>
                          <th>Fail</th>
                          <th>Remark</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% item.repairs.forEach((repair, repairIndex) => { %>
                          <tr>
                            <td><%= repairIndex + 1 %></td>
                            <td><%= new Date(repair.repairdate).toDateString() %></td>
                            <td><%= repair.computername ? repair.computername.computername : '' %></td>
                            <td><%= repair.detailrepair %></td>
                            <td><%= repair.value %></td>
                            <td><%= repair.success %></td>
                            <td><%= repair.fail %></td>
                            <td><%= repair.repairremark %></td>
                          </tr>
                        <% }); %>
                        <tr>
                          <td colspan="4" class="text-end"><strong>Total Value:</strong></td>
                          <td colspan="5"><strong><%= item.totalValue %></strong></td>
                        </tr>
                    </table>
                </td>
                </tbody>
                </table>
              <% } %>
      <% }); %>

<!-- แสดงปุ่มเลือกหน้า -->
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <% if (totalPages > 1) { %>
      <!-- First page button -->
      <li class="page-item <%= currentPage == 1 ? ' disabled' : '' %>">
                                        <a class="page-link"
                                            href="/Report/getalldetail?query=<%= typeof query !== 'undefined' ? query : '' %>&page=1&limit=<%= typeof limit !== 'undefined' ? limit : 2 %>">&laquo;</a>
                                        </li>

                                        <!-- Previous page button -->
                                        <li class="page-item <%= currentPage == 1 ? 'disabled' : '' %>">
                                            <a class="page-link"
                                                href="/Report/getalldetail?query=<%= typeof query !== 'undefined' ? query : '' %>&page=<%= currentPage - 1 %>&limit=<%= typeof limit !== 'undefined' ? limit : 2 %>">&lsaquo;</a>
                                        </li>

                                        <% for (let i=Math.max(1, currentPage - 2); i <=Math.min(totalPages, currentPage
                                            + 2); i++) { %>
                                            <li class="page-item <%= i == currentPage ? 'active' : '' %>">
                                                <a class="page-link"
                                                    href="/Report/getalldetail?query=<%= typeof query !== 'undefined' ? query : '' %>&page=<%= i %>&limit=<%= typeof limit !== 'undefined' ? limit : 2 %>">
                                                    <%= i %>
                                                </a>
                                            </li>
                                            <% } %>

                                                <!-- Next page button -->
                                                <li
                                                    class="page-item <%= currentPage == totalPages ? 'disabled' : '' %>">
                                                    <a class="page-link"
                                                        href="/Report/getalldetail?query=<%= typeof query !== 'undefined' ? query : '' %>&page=<%= currentPage + 1 %>&limit=<%= typeof limit !== 'undefined' ? limit : 2 %>">&rsaquo;</a>
                                                </li>

                                                <!-- Last page button -->
                                                <li
                                                    class="page-item <%= currentPage == totalPages ? 'disabled' : '' %>">
                                                    <a class="page-link"
                                                        href="/Report/getalldetail?query=<%= typeof query !== 'undefined' ? query : '' %>&page=<%= totalPages %>&limit=<%= typeof limit !== 'undefined' ? limit : 2 %>">&raquo;</a>
                                                </li>
                                                <% } %>
                                                    </ul>
                                                    </nav>


                                                    <% } else { %>
                                                        <p>No data available</p>
                                                        <% } %>
                </div>
                <script src="/javascripts/Report.js"></script>
</body>

</html>